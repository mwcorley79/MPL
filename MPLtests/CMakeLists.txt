# CMake project to build the MPL test stubs in TCPConnectorTest and TCPResponderTest,
# defined by the test stubs (TEST_CONNECTOR in TCPConnector.cpp) and (TEST_RESPONDER in TCPResponder.cpp)

# before running this CMake process, be sure to run the Cmake process for the MPL project,
# as this this depends on MPL library targets generated by the MPL project

# Mike C.

 cmake_minimum_required(VERSION 3.10)
project(TEST_MPL)

####################### Build MPL Test stub targets ################################

# set to c++ 17 (standard) 
set(CMAKE_CXX_STANDARD 17)

# include all the headers from the include folder
include_directories(../../MPL/install/include)

link_directories( ../../MPL/install/lib)

# generate the TCPResponder test stub target (executable test) from the SOURCES
add_executable(TCPResponderTest ../../MPL/src/TCPResponder.cpp)
target_compile_definitions(TCPResponderTest PUBLIC TEST_RESPONDER LINK_MPL)

# generate the TCPConnector test stub target (executable test) from the SOURCES
add_executable(TCPConnectorTest ../../MPL/src/TCPConnector.cpp)
target_compile_definitions(TCPConnectorTest PUBLIC TEST_CONNECTOR)

if (UNIX)
    # link MPL.so and pthread to the ReceiverTest and SenderTest targets for LINUX
    target_link_libraries (TCPResponderTest MPL.a pthread)
    target_link_libraries (TCPConnectorTest MPL.a pthread)
else (NOT UNIX) 
    # link MPL.dll to TCPResponderTest  and TCPConnectorTest targets for WINDOWS
    target_link_libraries (TCPResponderTest MPL.lib)
    target_link_libraries (TCPConnectorTest MPL.lib)
endif (UNIX)


