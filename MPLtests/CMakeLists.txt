# CMake project to build the MPL test stubs in SenderTest and ReceieverTest,
# defined by the test stubs (TEST_SENDER in Sender.cpp) and (TEST_RECEIVER in Receiver.cpp)

# before running this CMake process, be sure to run the Cmake process for the MPL project,
# as this this depends on MPL library targets generated by the MPL project

# As of 7/6/20 this "should" build working code on Linux, and will compile for the Windows,
# but the port of TCP sockets class (TCPSocket.h/cpp) isn't yet fully complete for Windows

# Mike C.

 cmake_minimum_required(VERSION 3.10)
project(TEST_MPL)

####################### Build MPL Test stub targets ################################

# set to c++ 17 (standard) 
set(CMAKE_CXX_STANDARD 17)

# include all the headers from the include folder
include_directories(../../MPL/install/include)

link_directories( ../../MPL/install/lib)

# generate the Receiver test stub target (executable test) from the SOURCES
add_executable(ReceiverTest ../../MPL/src/Receiver.cpp)
target_compile_definitions(ReceiverTest PUBLIC TEST_RECEIVER)

# generate the Sender test stub target (executable test) from the SOURCES
add_executable(SenderTest ../../MPL/src/Sender)
target_compile_definitions(SenderTest PUBLIC TEST_SENDER)

if (UNIX)
    # link MPL.so and pthread to the ReceiverTest and SenderTest targets for LINUX
    target_link_libraries (ReceiverTest MPL.so pthread)
    target_link_libraries (SenderTest MPL.so pthread)
else (NOT UNIX) 
    # link MPL.dll to ReceiverTest and SenderTest targets for WINDOWS
    target_link_libraries (ReceiverTest MPL.dll)
    target_link_libraries (SenderTest MPL.dll)
endif (UNIX)


