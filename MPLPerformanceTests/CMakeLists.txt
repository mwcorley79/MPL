# CMake project to build the MPL performance tests in PerformanceConnector and PerformanceResponder

# before running this CMake process, be sure to run the Cmake process for the MPL project,
# as this this depends on MPL library targets generated by the MPL project

# Mike C.

 cmake_minimum_required(VERSION 3.10)
project(MPL_PERFORMANCE_TEST)

####################### Build MPL Test stub targets ################################

# set to c++ 17 (standard) 
set(CMAKE_CXX_STANDARD 17)

# include all the headers from the install include folder
#include_directories(../../MPL/install/include ./include )
include_directories(../../MPL/include ./include )

# add install folder to linker search path: enable linker to find libMPL
# link_directories( ../../MPL/install/lib)
link_directories( ../../MPL/build)

# generate the TCPResponderPerfTest test stub target (executable test) from the SOURCES
add_executable(TCPResponderPerfTest ./src/PerformanceResponder.cpp)

# generate the TCPConnector test stub target (executable test) from the SOURCES
add_executable(TCPConnectorPerfTest ./src/PerformanceConnector.cpp)

if (UNIX)
    # link libMPL and pthread to the targets for LINUX
    target_link_libraries (TCPResponderPerfTest MPL.a pthread)
    target_link_libraries (TCPConnectorPerfTest MPL.a pthread)
else (NOT UNIX) 
    # link MPL.dll to TCPResponderTest  and TCPConnectorTest targets for WINDOWS
    target_link_libraries (TCPResponderPerfTest MPL.lib)
    target_link_libraries (TCPConnectorPerfTest MPL.lib)
endif (UNIX)


